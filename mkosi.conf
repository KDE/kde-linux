# SPDX-License-Identifier: GPL-2.0-only OR GPL-3.0-only OR LicenseRef-KDE-Accepted-GPL
# SPDX-FileCopyrightText: 2023 Harald Sitter <sitter@kde.org>

[Distribution]
Distribution=arch
Mirror=https://mirror.23m.com/archlinux/

[Output]
Format=directory
SplitArtifacts=yes

[Content]
# We do not want an initrd or any other boot artifacts, we generate all this stuff ourselves since we need more
# control than mkosi gives us. Bootable also has the unfortunate side effect that the os-release file gets eaten
# for some reason (supposedly as a side effect of the initrd creation?)
Bootable=no
KernelCommandLine=
Packages=sddm
         bash-completion
         pacman
         mesa
         pipewire
         pipewire-pulse
         pipewire-zeroconf
         pipewire-libcamera
         noto-fonts
         acpid
         busybox
         nvme-cli
         bind
         dmidecode
         ntfs-3g
         iproute2
         tpm2-tss
         xz
         wireplumber
         flatpak
         apparmor
         ffmpeg # ffmpegthumbs
         jxrlib # kimageformats
         libavif # kimageformats
         libheif # kimageformats
         libjxl # kimageformats
         libraw # kimageformats
         openexr # kimageformats
         freerdp2 #krdp
WithNetwork=true
# No root login thank you very much. We'll provision a live user as part of spinup
# RootPassword=
# Make sure kernel-install knows where we expect the ESP to be mounted so it can create correct loader entries.
@Environment=BOOT_MNT=/efi-template
# TODO: revisit pulseaudio qt it should be pulled in implicitly but isn't right now
@Environment=KDE_BUILDER_TARGET="pulseaudio-qt workspace dolphin-plugins ffmpegthumbs kdegraphics-thumbnailers kimageformats kio-fuse kio-gdrive kpmcore spectacle xwaylandvideobridge partitionmanager kde-inotify-survey kdeconnect-kde krdp kdenetwork-filesharing"

[Host]
QemuGui=yes
