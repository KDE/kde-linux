#!/bin/env python

# SPDX-License-Identifier: GPL-2.0-only OR GPL-3.0-only OR LicenseRef-KDE-Accepted-GPL
# SPDX-FileCopyrightText: 2024 Harald Sitter <sitter@kde.org>

import os
import subprocess
import shutil

if __name__ == '__main__':
    debugroot = '/tmp/debugroot'

    extension_dir = f'{debugroot}/usr/lib/extension-release.d/'
    os.makedirs(extension_dir)
    shutil.copy2('/usr/lib/os-release', f'{extension_dir}/extension-release.debug')

    tar = 'debug.tar'
    subprocess.run(['tar', '-C', f'{debugroot}/', '-cf', tar, '.'])
    subprocess.run(['zstd', '-T0', '--rm', tar])
